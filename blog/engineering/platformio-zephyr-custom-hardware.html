<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="icon" href="/assets/favicon/favicon.png" type="image/png" /><link rel="apple-touch-icon" href="/assets/favicon/apple-touch-icon.png" /><link rel="stylesheet" href="/assets/css/libs.bundle.css?v=3" /><link rel="stylesheet" href="/assets/css/theme.bundle.css?v=3" /><title>Enabling PlatformIO and Zephyr on custom hardware | PlatformIO Labs</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Enabling PlatformIO and Zephyr on custom hardware" /><meta name="author" content="Valerii Koval" /><meta property="og:locale" content="en_US" /><meta name="description" content="Adding support for custom hardware based on Nordic nRF52833 SoC in PlatformIO and Zephyr" /><meta property="og:description" content="Adding support for custom hardware based on Nordic nRF52833 SoC in PlatformIO and Zephyr" /><link rel="canonical" href="https://piolabs.com/blog/engineering/platformio-zephyr-custom-hardware.html" /><meta property="og:url" content="https://piolabs.com/blog/engineering/platformio-zephyr-custom-hardware.html" /><meta property="og:site_name" content="PlatformIO Labs" /><meta property="og:image" content="https://piolabs.com/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-1.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-12T00:00:00+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://piolabs.com/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-1.png" /><meta property="twitter:title" content="Enabling PlatformIO and Zephyr on custom hardware" /><meta name="twitter:site" content="@PlatformIO_Org" /><meta name="twitter:creator" content="@Valerii Koval" /> <script type="application/ld+json"> {"image":"https://piolabs.com/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-1.png","url":"https://piolabs.com/blog/engineering/platformio-zephyr-custom-hardware.html","headline":"Enabling PlatformIO and Zephyr on custom hardware","dateModified":"2020-10-12T00:00:00+03:00","datePublished":"2020-10-12T00:00:00+03:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://piolabs.com/assets/img/platformio-logo-icon.png"},"name":"Valerii Koval"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://piolabs.com/blog/engineering/platformio-zephyr-custom-hardware.html"},"author":{"@type":"Person","name":"Valerii Koval"},"description":"Adding support for custom hardware based on Nordic nRF52833 SoC in PlatformIO and Zephyr","@type":"BlogPosting","@context":"https://schema.org"}</script><link type="application/atom+xml" rel="alternate" href="https://piolabs.com/feed.xml" title="PlatformIO Labs" /></head><body><nav class="navbar navbar-expand-lg navbar-light"><div class="container"> <a class="navbar-brand" href="/"> <img src="/assets/img/platformio-labs-logo-horizontal.png" class="navbar-brand-img" alt="PlatformIO Labs"> </a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button><div class="collapse navbar-collapse" id="navbarCollapse"> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <i class="fe fe-x"></i> </button><ul class="navbar-nav ms-auto"><li class="nav-item"> <a class="nav-link" href="/">Home</a></li><li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" id="navbarTechnology" data-bs-toggle="dropdown" href="#" aria-haspopup="true" aria-expanded="false"> Technology </a><div class="dropdown-menu dropdown-menu-xl p-0" aria-labelledby="navbarTechnology"><div class="row gx-0"><div class="col-12 col-lg-6"><div class="dropdown-img-start"><h3 class="text-white"> In-house IDE or Next-Gen?</h3><p class="fs-sm text-white text-center"> See comparison of the existing IDE solutions in the market</p><a href="/blog/insights/next-generation-ide-for-decades.html" class="btn btn-sm btn-white shadow-dark fonFt-size-sm"> Learn More </a></div></div><div class="col-12 col-lg-6 dropdown-body"><div class="list-group list-group-flush"> <a class="list-group-item" href="/technology/next-generation-ide-framework.html"><div class="icon icon-sm text-primary-desat"> <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M17.272 8.685a1 1 0 111.456-1.37l4 4.25a1 1 0 010 1.37l-4 4.25a1 1 0 01-1.456-1.37l3.355-3.565-3.355-3.565zm-10.544 0L3.373 12.25l3.355 3.565a1 1 0 01-1.456 1.37l-4-4.25a1 1 0 010-1.37l4-4.25a1 1 0 011.456 1.37z" fill="#335EEA" /> <rect fill="#335EEA" opacity=".3" transform="rotate(15 12 12)" x="11" y="4" width="2" height="16" rx="1" /> </g> </svg></div><div class="ms-4"><h6 class="text-uppercase text-primary-desat mb-0"> Next-Gen IDE Framework</h6><p class="fs-sm text-gray-700 mb-0"> Flexible, free IDE for everyone</p></div></a> <a class="list-group-item" href="/technology/modern-ui-toolkit.html"><div class="icon icon-sm text-success"> <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M5.5 4h4A1.5 1.5 0 0111 5.5v1A1.5 1.5 0 019.5 8h-4A1.5 1.5 0 014 6.5v-1A1.5 1.5 0 015.5 4zm9 12h4a1.5 1.5 0 011.5 1.5v1a1.5 1.5 0 01-1.5 1.5h-4a1.5 1.5 0 01-1.5-1.5v-1a1.5 1.5 0 011.5-1.5z" fill="#335EEA" /><path d="M5.5 10h4a1.5 1.5 0 011.5 1.5v7A1.5 1.5 0 019.5 20h-4A1.5 1.5 0 014 18.5v-7A1.5 1.5 0 015.5 10zm9-6h4A1.5 1.5 0 0120 5.5v7a1.5 1.5 0 01-1.5 1.5h-4a1.5 1.5 0 01-1.5-1.5v-7A1.5 1.5 0 0114.5 4z" fill="#335EEA" opacity=".3" /> </g> </svg></div><div class="ms-4"><h6 class="text-uppercase text-success mb-0"> Modern UI Toolkit</h6><p class="fs-sm text-gray-700 mb-0"> Build beautiful user interfaces</p></div></a> <a class="list-group-item" href="/technology/trusted-package-registry.html"><div class="icon icon-sm text-danger"> <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M5.5 2h13A1.5 1.5 0 0120 3.5v3A1.5 1.5 0 0118.5 8h-13A1.5 1.5 0 014 6.5v-3A1.5 1.5 0 015.5 2zM11 4a1 1 0 000 2h2a1 1 0 000-2h-2z" fill="#335EEA" opacity=".3" /><path d="M5.5 9h13a1.5 1.5 0 011.5 1.5v3a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 014 13.5v-3A1.5 1.5 0 015.5 9zm5.5 2a1 1 0 000 2h2a1 1 0 000-2h-2zm-5.5 5h13a1.5 1.5 0 011.5 1.5v3a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 014 20.5v-3A1.5 1.5 0 015.5 16zm5.5 2a1 1 0 000 2h2a1 1 0 000-2h-2z" fill="#335EEA" /> </g> </svg></div><div class="ms-4"><h6 class="text-uppercase text-danger mb-0"> Trusted Package Registry</h6><p class="fs-sm text-gray-700 mb-0"> Package management solution</p></div></a> <a class="list-group-item" href="https://platformio.org/"><div class="icon icon-sm text-dark"> <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path d="M18 14a3 3 0 110-6 3 3 0 010 6zm-9-3a4 4 0 110-8 4 4 0 010 8z" fill="#335EEA" opacity=".3" /><path d="M17.601 15c3.407.038 6.188 1.76 6.397 5.4.009.147 0 .6-.542.6H19.6c0-2.25-.744-4.328-1.999-6zm-17.6 5.2C.388 15.426 4.26 13 8.983 13c4.788 0 8.722 2.293 9.015 7.2.012.195 0 .8-.751.8H.727c-.25 0-.747-.54-.726-.8z" fill="#335EEA" /> </g> </svg></div><div class="ms-4"><h6 class="text-uppercase text-dark mb-0"> PlatformIO Open Source</h6><p class="fs-sm text-gray-700 mb-0"> Collaborative platform <i class="fe fe-log-out ms-3"></i></p></div></a></div></div></div></div></li><li class="nav-item"> <a class="nav-link" href="/blog/">Blog</a></li><li class="nav-item"> <a class="nav-link" href="/company/about.html">Company</a></li><li class="nav-item ps-lg-10 pt-2"><ul class="list-unstyled list-inline list-social "><li class="list-inline-item list-social-item me-3"> <a href="https://www.linkedin.com/company/platformio/" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="Follow on LinkedIn" title="Follow on LinkedIn"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://twitter.com/PlatformIO_Org" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/twitter.svg" class="list-social-icon" alt="Follow on Twitter" title="Follow on Twitter"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://github.com/platformio" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/github.svg" class="list-social-icon" alt="Follow on Github" title="Follow on Github"> </a></li></ul></li></ul></div></div></nav><div class="bg-light border-top"><nav class="bg-gray-200"><div class="container"><div class="row"><div class="col-12"><ol class="breadcrumb breadcrumb-scroll"><li class="breadcrumb-item"> <a href="/blog/" class="text-gray-700"> Blog </a></li><li class="breadcrumb-item"> <a href="/blog/engineering/" class="text-gray-700"> Engineering </a></li><li class="breadcrumb-item active" aria-current="page"> Enabling PlatformIO and Zephyr on custom hardware</li></ol></div></div></div></nav><article class="bg-white"><section class="pt-8 pt-md-11"><div class="container"><div class="row justify-content-center"><div class="col-12 col-md-10 col-lg-9 col-xl-8"><h1 class="display-4 text-center"> Enabling PlatformIO and Zephyr on custom hardware</h1><p class="lead mb-7 text-center text-muted"> A straightforward tutorial on adding support for a custom board that works with both Zephyr and PlatformIO</p><div class="row align-items-center py-5 border-top border-bottom"><div class="col-auto"><div class="avatar avatar-lg"> <a href="https://www.linkedin.com/in/valeros/" target="_blank"><img src="/assets/img/avatars/vkoval.jpg" alt="Valerii Koval" class="avatar-img rounded-circle"></a></div></div><div class="col ms-n5"><h6 class="text-uppercase mb-0"> <a href="https://www.linkedin.com/in/valeros/" target="_blank">Valerii Koval</a></h6><div class="fs-sm text-muted"> Head of System Integration at PlatformIO Labs</div></div><div class="col-auto"> <span class="h6 text-uppercase text-muted d-none d-md-inline me-4"> Share: </span><ul class="list-unstyled list-inline list-social "><li class="list-inline-item list-social-item me-3"> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="Follow on LinkedIn" title="Follow on LinkedIn"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/twitter.svg" class="list-social-icon" alt="Follow on Twitter" title="Follow on Twitter"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/facebook.svg" class="list-social-icon" alt="Follow on Facebook" title="Follow on Facebook"> </a></li></ul></div></div></div></div></div></section><section class="pt-6 pt-md-8"><div class="container"><div class="row justify-content-center"><div class="col-12 col-md-10 col-lg-9 col-xl-8"><p>In this post, we will create a simple BLE beacon that broadcasts its name as the payload. We will use the Zephyr RTOS on a custom board based on the Nordic nRF52833 SoC. A JLink debug probe will be used for uploading and debugging our application.</p><h3>Table of Contents</h3><ul id="markdown-toc"><li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li><li><a href="#what-is-the-zephyr-project" id="markdown-toc-what-is-the-zephyr-project">What is the Zephyr Project?</a></li><li><a href="#getting-started" id="markdown-toc-getting-started">Getting Started</a><ul><li><a href="#installing-nordic-nrf52-dev-platform" id="markdown-toc-installing-nordic-nrf52-dev-platform">Installing Nordic nRF52 dev-platform</a></li><li><a href="#project-setup" id="markdown-toc-project-setup">Project setup</a></li><li><a href="#adding-a-custom-board-to-zephyr" id="markdown-toc-adding-a-custom-board-to-zephyr">Adding a custom board to Zephyr</a></li><li><a href="#adding-a-custom-board-to-platformio" id="markdown-toc-adding-a-custom-board-to-platformio">Adding a custom board to PlatformIO</a></li><li><a href="#compile-and-upload" id="markdown-toc-compile-and-upload">Compile and Upload</a></li><li><a href="#debugging" id="markdown-toc-debugging">Debugging</a></li></ul></li><li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li><li><a href="#stay-in-touch-with-us" id="markdown-toc-stay-in-touch-with-us">Stay in touch with us</a></li></ul><h2 id="prerequisites">Prerequisites</h2><p>This article uses the following components:</p><ul><li><a href="https://docs.platformio.org/en/latest/integration/ide/vscode.html">VSCode with installed PlatformIO IDE extension</a></li><li>Any board based on <a href="https://www.nordicsemi.com/Products/Low-power-short-range-wireless/nRF52833">Nordic nRF52833 SoC</a></li><li>Any <a href="https://www.segger.com/products/debug-probes/j-link/">JLink probe</a> (used for uploading and debugging)</li></ul><h2 id="what-is-the-zephyr-project">What is the Zephyr Project?</h2><p>The Zephyr Project is a scalable real-time operating system (RTOS) supporting multiple hardware architectures, optimized for resource-constrained devices, and built with security in mind.</p><p>The Zephyr Project is perfect for building simple connected sensors, LED wearables, up to modems and small IoT wireless gateways. Because the Zephyr RTOS is modular and supports multiple architectures, developers are able to easily come up with optimal applications to meet their needs. As a true open source project, the community can evolve the project to support new hardware, developer tools, sensors, and device drivers. Enhancements in security, device management capabilities, connectivity stacks, and file systems can be easily implemented.</p><p>Zephyr RTOS has several great features that make it a good choice for developing embedded applications. The Zephyr RTOS’s goal is to establish a neutral project where silicon vendors, OEMs, ODMs, ISVs, and OSVs can contribute technology to reduce the cost and accelerate time to market for developing the billions of devices that will make up the majority of the Internet of Things. The operating system itself also has a number of powerful features, including a device model, symmetric multiprocess support, and rich networking and Bluetooth stacks.</p><p>Zephyr RTOS is open source under the Apache 2.0 license and the source code is available on <a href="https://github.com/zephyrproject-rtos/zephyr">GitHub</a>.</p><h2 id="getting-started">Getting Started</h2><h3 id="installing-nordic-nrf52-dev-platform">Installing Nordic nRF52 dev-platform</h3><p>PlatformIO dev-platforms contain a lot of required information about supported packages (toolchains, SDKs, uploaders, etc), configurations for popular development boards/kits, examples. Also, all dev-platforms include predefined build scripts that help you compile, upload, and debug embedded applications. The platform can be installed automatically when you run your project the first time we can use <a href="https://docs.platformio.org/en/latest/home/index.html">PlatformIO Home</a> directly in the IDE.</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-2.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-2.png" /> </a></p><p>Alternatively, you can install the platform manually from CLI using the following command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>platformio platform <span class="nb">install </span>nordicnrf52
</code></pre></div></div><h3 id="project-setup">Project setup</h3><p>Once the <code class="language-plaintext highlighter-rouge">nordicnrf52</code> dev-platform is installed, we have everything to start developing for the Zephyr RTOS. The platform already contains a BLE beacon example that we can use as a boilerplate for our project. To import the example, open the <code class="language-plaintext highlighter-rouge">PlatformIO Home</code> page and press the <code class="language-plaintext highlighter-rouge">Project Examples</code> button in the <code class="language-plaintext highlighter-rouge">Quick Access</code> menu, type <code class="language-plaintext highlighter-rouge">zephyr-ble-beacon</code> in the input field and push the <code class="language-plaintext highlighter-rouge">Import</code> button:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-3.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-3.png" /> </a></p><p>After the successful import you should see a typical PlatformIO project with a bunch of folders and a special <code class="language-plaintext highlighter-rouge">platformio.ini</code> file:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>project_dir
├── include
├── lib
├── src
│    └── main.c
├── test
├── zephyr
│    ├── prj.conf
│    └── CMakeLists.txt
└── platformio.ini
</code></pre></div></div><p>Besides files and folders related to PlatformIO, there is a special folder <code class="language-plaintext highlighter-rouge">zephyr</code> that contains Zephyr-specific files <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> and <code class="language-plaintext highlighter-rouge">prj.conf</code>, a rough description of these files is the following:</p><ul><li><code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>: tells the build system where to find the other application files, and links the application directory with Zephyr’s build system. This link provides features supported by Zephyr’s build system, such as board-specific kernel configuration files, the ability to run and debug compiled binaries on real or emulated hardware, and more.</li><li><code class="language-plaintext highlighter-rouge">prj.conf</code>: describes application-specific values for one or more kernel configuration options. These application settings are merged with board-specific settings to produce a kernel configuration.</li></ul><p>Since PlatformIO is able to generate CMake-based projects for certain IDEs, Zephyr-specific files are moved to a separate folder <code class="language-plaintext highlighter-rouge">zephyr</code> in order to avoid conflicts between CMakeLists.txt files. That requires users to specify relative paths to source files in already existing projects. After adding Zephyr-specific files, our project should look like this:</p><p>If you need more information about configuration steps, please go through the official PlatformIO <a href="https://docs.platformio.org/en/latest/frameworks/zephyr.html">configuration guide</a> for the Zephyr project.</p><h3 id="adding-a-custom-board-to-zephyr">Adding a custom board to Zephyr</h3><p>Since our board is neither directly supported by Zephyr nor by PlatformIO, we need to create the required board files manually. First, let’s add support for our board to Zephyr. There is comprehensive <a href="https://docs.zephyrproject.org/latest/application/index.html#custom-board-definition">official Zephyr documentation</a> on how to integrate out-of-tree board definitions. In a nutshell, the structure needed to support an out-of-tree board or SoC development is similar to how boards and SoCs are maintained in the official Zephyr tree.</p><p>Fortunately, our board uses the Nordic nRF52833 SoC that’s already supported and used in the <code class="language-plaintext highlighter-rouge">nrf52833dk_nrf52833</code> board. We can use that board as boilerplate, so we just need to copy and modify the board files according to our needs. Adding a custom board is usually done using the following structure <code class="language-plaintext highlighter-rouge">boards/&lt;architecture&gt;/&lt;board_name&gt;</code>. Files in this folder extend the SoC configuration, apply the pin-muxing settings, and much more. A special file <code class="language-plaintext highlighter-rouge">&lt;board_name&gt;_defconfig</code> defines which SoC and basic features and interfaces are included.</p><p>Navigate to <code class="language-plaintext highlighter-rouge">$PLATFORMIO_PACKAGES_DIR/framework-zephyr/boards/arm/nrf52833dk_nrf52833</code> where <a href="https://docs.platformio.org/en/latest/projectconf/section_platformio.html?highlight=core_dir#packages-dir">PLATFORMIO_PACKAGES_DIR</a> is a special folder with all installed PlatformIO packages. Copy all files from <code class="language-plaintext highlighter-rouge">nrf52833dk_nrf52833</code> folder to the <code class="language-plaintext highlighter-rouge">zephyr</code> folder in our project so the final path will look like <code class="language-plaintext highlighter-rouge">zephyr/boards/arm/ble_beacon_nrf52833</code>. Then rename the files according to our board name <code class="language-plaintext highlighter-rouge">ble_beacon_nrf52833</code>, the final files should look like the following:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>board.cmake
Kconfig
Kconfig.board
Kconfig.defconfig
ble_beacon_nrf52833_defconfig
ble_beacon_nrf52833.dts
ble_beacon_nrf52833.yaml
</code></pre></div></div><p>After that we need to fix values in <code class="language-plaintext highlighter-rouge">Kconfig.board</code>, <code class="language-plaintext highlighter-rouge">Kconfig.defconfig</code>, <code class="language-plaintext highlighter-rouge">ble_beacon_nrf52833.yaml</code>, <code class="language-plaintext highlighter-rouge">ble_beacon_nrf52833_defconfig</code> so the Zephyr build system will be able to generate configuration and C definitions for our board.</p><p>Once the board structure is ready, we need to specify the location of our custom board information with the <code class="language-plaintext highlighter-rouge">BOARD_ROOT</code> parameter to the CMake build system. The easiest way is to specify this path at the top of <code class="language-plaintext highlighter-rouge">CMakeList.txt</code> file like this:</p><div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Path to out-of-tree boards definitions</span>
<span class="nb">set</span> <span class="p">(</span>BOARD_ROOT <span class="s2">"</span><span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">cmake_minimum_required</span><span class="p">(</span>VERSION 3.13.1<span class="p">)</span>
<span class="nb">include</span><span class="p">(</span>$ENV{ZEPHYR_BASE}/cmake/app/boilerplate.cmake NO_POLICY_SCOPE<span class="p">)</span>
<span class="nb">project</span><span class="p">(</span>custom-board<span class="p">)</span>

<span class="nb">target_sources</span><span class="p">(</span>app PRIVATE ../src/main.c<span class="p">)</span>
</code></pre></div></div><h3 id="adding-a-custom-board-to-platformio">Adding a custom board to PlatformIO</h3><p>The next step is to add support for our board to the PlatformIO <code class="language-plaintext highlighter-rouge">nordicnrf52</code> dev-platform. The easiest and most portable way to do it is to create a new folder <code class="language-plaintext highlighter-rouge">boards</code> in the root of our project and add a special JSON manifest file with the name of our board <code class="language-plaintext highlighter-rouge">ble_beacon_nrf52833.json</code> and with the following contents:</p><div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"cpu"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cortex-m4"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"f_cpu"</span><span class="p">:</span><span class="w"> </span><span class="s2">"64000000L"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"mcu"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nrf52833"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"zephyr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"variant"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ble_beacon_nrf52833"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"connectivity"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"bluetooth"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"debug"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"jlink_device"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nRF52833_xxAA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"svd_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nrf52.svd"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"frameworks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"zephyr"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BLE Beacon nRF52833"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"upload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"maximum_ram_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">131072</span><span class="p">,</span><span class="w">
      </span><span class="nl">"maximum_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">524288</span><span class="p">,</span><span class="w">
      </span><span class="nl">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jlink"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"jlink"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"vendor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Vendor Name"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div><p>Let’s briefly go through the main parts of the above configuration:</p><ul><li>The <code class="language-plaintext highlighter-rouge">build</code> section contains information about CPU architecture, framework configurations, MCU name, etc. As the variant for Zephyr, we specified the same name as the board name used in the Zephyr configuration files</li><li>The <code class="language-plaintext highlighter-rouge">debug</code> section sets the configuration for debug tools and the path SVD file. Since we plan to use a JLink probe, we need to specify the <code class="language-plaintext highlighter-rouge">jlink_device</code> name used for connecting to our board. The list of supported JLink devices can be found on <a href="https://www.segger.com/downloads/supported-devices.php">the official JLink website</a></li><li>The <code class="language-plaintext highlighter-rouge">framework</code> represents is a list of supported frameworks/SDKs which can be used with our board. We plan to use only Zephyr, so we specified only one framework.</li><li>The <code class="language-plaintext highlighter-rouge">upload</code> section specifies maximum memory sizes and available upload protocols. We specified <code class="language-plaintext highlighter-rouge">jlink</code> as the protocol since we plan to use the debug probe to upload firmware to the device.</li></ul><p>Other sections are not mandatory, but they might be useful if we decide to push our board manifest to the upstream repository to make the board publicly available for other users. More detailed information about the JSON structure of board manifests can be found in the <a href="https://docs.platformio.org/en/latest/platforms/creating_board.html#json-structure">PlatformIO Docs</a>.</p><p>The final project structure should like this:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>project_dir
├── boards
│     └── ble_beacon_nrf52833.json
├── include
├── lib
├── src
│    └── main.c
├── test
├── zephyr
│    ├── boards
│    │     └── arm
│    │          └── ble_beacon_nrf52833
│    ├── prj.conf
│    └── CMakeLists.txt
└── platformio.ini
</code></pre></div></div><p>After that we can use the new board in <code class="language-plaintext highlighter-rouge">platformio.ini</code> file:</p><div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[env:ble_beacon_nrf52833]</span>
<span class="py">platform</span> <span class="p">=</span> <span class="s">nordicnrf52</span>
<span class="py">framework</span> <span class="p">=</span> <span class="s">zephyr</span>
<span class="py">board</span> <span class="p">=</span> <span class="s">ble_beacon_nrf52833</span>

<span class="c">; Use the debug probe for uploading
</span><span class="py">upload_protocol</span> <span class="p">=</span> <span class="s">jlink</span>
</code></pre></div></div><p>Note that we need to specify <code class="language-plaintext highlighter-rouge">jlink</code> as the upload method to force PlatformIO to use the debug probe for uploading.</p><h3 id="compile-and-upload">Compile and Upload</h3><p>After the previous configuration steps, we are ready to compile the project. It can be done using the CLI command <code class="language-plaintext highlighter-rouge">platformio run</code> or via the <code class="language-plaintext highlighter-rouge">Build</code> button on the Toolbar:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-4.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-4.png" /> </a></p><p>If everything went well, we should see a successful result message in the terminal window:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-5.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-5.png" /> </a></p><p>Uploading the code to the board varies across hardware platforms. As for this article, the board is connected to the computer via a JLink debug probe so it will be used to flash the firmware. Just make sure your board is connected to the computer and run the CLI command <code class="language-plaintext highlighter-rouge">platformio run -t upload</code> or use the <code class="language-plaintext highlighter-rouge">Upload</code> button on the Toolbar:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-6.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-6.png" /> </a></p><p>If everything went well, we can open any desktop/mobile application which is able to show near BLE devices, for example here is how the device is showed in the <code class="language-plaintext highlighter-rouge">nRF Connect</code> tool:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-7.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-7.png" /> </a></p><h3 id="debugging">Debugging</h3><p>The PlatformIO dev-platforms already have predefined configurations for popular debug probes, including the JLink probe used in this article. All we need is to specify <code class="language-plaintext highlighter-rouge">debug_tool</code> in <code class="language-plaintext highlighter-rouge">platformio.ini</code> file:</p><div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[env:ble_beacon_nrf52833]</span>
<span class="py">platform</span> <span class="p">=</span> <span class="s">nordicnrf52</span>
<span class="py">framework</span> <span class="p">=</span> <span class="s">zephyr</span>
<span class="py">board</span> <span class="p">=</span> <span class="s">ble_beacon_nrf52833</span>

<span class="py">upload_protocol</span> <span class="p">=</span> <span class="s">jlink</span>
<span class="py">debug_tool</span> <span class="p">=</span> <span class="s">jlink</span>
</code></pre></div></div><p>and push the <code class="language-plaintext highlighter-rouge">Debug</code> button. PlatformIO will do all the heavy lifting for us:</p><p><a data-bigpicture="{&quot;imgSrc&quot;: &quot;/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-8.png&quot;}" href="#"> <img class="img-fluid screenshot mw-md-100" src="/assets/posts/2020-10-12-platformio-zephyr-custom-hardware/platformio-zephyr-custom-hardware-8.png" /> </a></p><h2 id="conclusion">Conclusion</h2><p>In this post, we went over:</p><ul><li>An introduction to the Zephyr project</li><li>Setup and installation steps</li><li>Adding a custom board to Zephyr and PlatformIO</li><li>Compiling and uploading a simple BLE example</li><li>Debugging the application using a JLink probe</li></ul><p>Zephyr RTOS is a promising project with a long list of supported hardware. The active community, permissive license, comprehensive documentation, rich set of features, focus on security all this makes Zephyr a great choice for modern embedded development.</p><h2 id="stay-in-touch-with-us">Stay in touch with us</h2><p>Stay tuned to this blog or follow us on <a href="https://www.linkedin.com/company/platformio" target="_blank">LinkedIn</a> and Twitter <a href="https://twitter.com/PlatformIO_Org" target="_blank">@PlatformIO_Org</a> to keep up to date with the latest news, articles and tips!</p></div></div></div></section><section class="py-6 py-md-8"><div class="container"><div class="row justify-content-center"><div class="col-12 col-md-10 col-lg-9 col-xl-8"><div class="row align-items-center py-5 border-top border-bottom"><div class="col-auto"><div class="avatar avatar-lg"> <a href="https://www.linkedin.com/in/valeros/" target="_blank"><img src="/assets/img/avatars/vkoval.jpg" alt="Valerii Koval" class="avatar-img rounded-circle"></a></div></div><div class="col ms-n5"><h6 class="text-uppercase mb-0"> <a href="https://www.linkedin.com/in/valeros/" target="_blank">Valerii Koval</a></h6><div class="fs-sm text-muted"> <time datetime="2020-10-12T00:00:00+03:00"> Published on 12th Oct 2020 </time></div></div><div class="col-auto"> <span class="h6 text-uppercase text-muted d-none d-md-inline me-4"> Share: </span><ul class="list-unstyled list-inline list-social "><li class="list-inline-item list-social-item me-3"> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="Follow on LinkedIn" title="Follow on LinkedIn"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/twitter.svg" class="list-social-icon" alt="Follow on Twitter" title="Follow on Twitter"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fpiolabs.com%2Fblog%2Fengineering%2Fplatformio-zephyr-custom-hardware.html" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/facebook.svg" class="list-social-icon" alt="Follow on Facebook" title="Follow on Facebook"> </a></li></ul></div></div></div></div></div></section></article><section class="pt-4 pt-md-6 pb-8 pb-md-10 bg-white"><div class="container"><div class="row justify-content-center"><div class="col-12 col-md-10 col-lg-9 col-xl-8"><div class="row align-items-center"><div class="col-12 col-md"><h3 class="mb-1"> Have questions?</h3><p class="fs-lg text-muted mb-6 mb-md-0"> Join the discussion on our forum</p></div><div class="col-12 col-md-auto"> <a href="https://community.platformio.org/t/enabling-platformio-and-zephyr-on-custom-hardware/16506" class="btn btn-primary-soft me-1 lift" target="_blank"> Continue discussion <i class="fe fe-arrow-right ms-3"></i> </a></div></div></div></div></div></section><section class="pt-7 pb-9 pt-md-10 bg-light border-top"><div class="container"><div class="row align-items-center mb-5"><div class="col-12 col-md"><h3 class="mb-0"> Popular posts</h3></div><div class="col-12 col-md-auto"> <a href="/blog/latest.html" class="btn btn-sm btn-outline-gray-300 d-none d-md-inline"> View more </a></div></div><div class="row"><div class="col-12 col-md-6 col-lg-4 d-flex"><div class="card mb-6 shadow-light-lg lift lift-lg"> <a class="card-img-top" href="/blog/press-releases/platformio-labs-helps-imagination-technologies.html"> <img src="/assets/posts/2021-03-08-platformio-labs-helps-imagination-technologies/platformio-labs-helps-imagination-technologies-1.jpg" alt="PlatformIO Labs Helps Imagination Technologies Improve RISC-V Computer Architecture Training" class="card-img-top"><div class="position-relative"><div class="shape shape-bottom shape-fluid-x text-white"> <svg viewBox="0 0 2880 480" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2160 0C1440 240 720 240 720 240H0v240h2880V0h-720z" fill="currentColor" /> </svg></div></div></a> <a class="card-body" href="/blog/press-releases/platformio-labs-helps-imagination-technologies.html"><h3> PlatformIO Labs Helps Imagination Technologies Improve RISC-V Computer Architecture Training</h3><p class="mb-0 text-muted"> PlatformIO Labs joins efforts with industry leaders to satisfy the increasing demand for in-depth educational materials</p></a> <a class="card-meta mt-auto" href="/blog/press-releases/platformio-labs-helps-imagination-technologies.html"><hr class="card-meta-divider"><div class="avatar avatar-sm me-2"> <img src="/assets/img/avatars/ikravets.jpg" alt="Ivan Kravets" class="avatar-img rounded-circle"></div><h6 class="text-uppercase text-muted me-2 mb-0"> Ivan Kravets</h6><p class="h6 text-uppercase text-muted mb-0 ms-auto"> <time datetime="2021-03-08T00:00:00+02:00">Mar 08</time></p></a></div></div><div class="col-12 col-md-6 col-lg-4 d-flex"><div class="card mb-6 shadow-light-lg lift lift-lg"> <a class="card-img-top" href="/blog/news/openhw-tv-s2e04.html"> <img src="/assets/posts/2021-04-23-openhw-tv-s2e04/openhw-tv-s2e04-cover.jpg" alt="OpenHW TV S2 E04: Software Task Group Project Updates" class="card-img-top"><div class="position-relative"><div class="shape shape-bottom shape-fluid-x text-white"> <svg viewBox="0 0 2880 480" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2160 0C1440 240 720 240 720 240H0v240h2880V0h-720z" fill="currentColor" /> </svg></div></div></a> <a class="card-body" href="/blog/news/openhw-tv-s2e04.html"><h3> OpenHW TV S2 E04: Software Task Group Project Updates</h3><p class="mb-0 text-muted"> A brief summary of an event dedicated to the recent progress of the key projects led by the OpenHW Software Task Group</p></a> <a class="card-meta mt-auto" href="/blog/news/openhw-tv-s2e04.html"><hr class="card-meta-divider"><div class="avatar avatar-sm me-2"> <img src="/assets/img/avatars/ikravets.jpg" alt="Ivan Kravets" class="avatar-img rounded-circle"></div><h6 class="text-uppercase text-muted me-2 mb-0"> Ivan Kravets</h6><p class="h6 text-uppercase text-muted mb-0 ms-auto"> <time datetime="2021-04-23T00:00:00+03:00">Apr 23</time></p></a></div></div><div class="col-12 col-md-6 col-lg-4 d-flex"><div class="card mb-6 shadow-light-lg lift lift-lg"> <a class="card-img-top" href="/blog/insights/memory-analysis-part-1.html"> <img src="/assets/posts/2020-11-16-memory-analysis-part-1/memory-analysis-part-1-2.png" alt="Analyze your firmware footprint with PlatformIO: Part 1. Intro and basic analysis" class="card-img-top"><div class="position-relative"><div class="shape shape-bottom shape-fluid-x text-white"> <svg viewBox="0 0 2880 480" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2160 0C1440 240 720 240 720 240H0v240h2880V0h-720z" fill="currentColor" /> </svg></div></div></a> <a class="card-body" href="/blog/insights/memory-analysis-part-1.html"><h3> Analyze your firmware footprint with PlatformIO: Part 1. Intro and basic analysis</h3><p class="mb-0 text-muted"> The first part of a series on memory analysis in the PlatformIO ecosystem</p></a> <a class="card-meta mt-auto" href="/blog/insights/memory-analysis-part-1.html"><hr class="card-meta-divider"><div class="avatar avatar-sm me-2"> <img src="/assets/img/avatars/vkoval.jpg" alt="Valerii Koval" class="avatar-img rounded-circle"></div><h6 class="text-uppercase text-muted me-2 mb-0"> Valerii Koval</h6><p class="h6 text-uppercase text-muted mb-0 ms-auto"> <time datetime="2020-11-16T00:00:00+02:00">Nov 16</time></p></a></div></div></div></div></section></div><div class="position-relative"><div class="shape shape-bottom shape-fluid-x text-dark"> <svg viewBox="0 0 2880 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 48h2880V0h-720C1442.5 52 720 0 720 0H0v48z" fill="currentColor"/></svg></div></div><section class="bg-dark "><footer class="py-8 py-md-11 bg-dark border-gray-800-50 "><div class="container"><div class="row"><div class="col-12 col-md-6 col-lg-4"> <a href="/"><img src="/assets/img/platformio-labs-logo-horizontal-white.png" alt="PlatformIO Labs" class="img-fluid mb-2 mw-lg-75"></a><p class="text-gray-400 mb-2"> Make embedded developers and teams happy.</p><ul class="list-unstyled list-inline list-social mb-2"><li class="list-inline-item list-social-item me-3"> <a href="https://www.linkedin.com/company/platformio/" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/linkedin.svg" class="list-social-icon" alt="Follow on LinkedIn" title="Follow on LinkedIn"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://twitter.com/PlatformIO_Org" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/twitter.svg" class="list-social-icon" alt="Follow on Twitter" title="Follow on Twitter"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://www.facebook.com/platformio" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/facebook.svg" class="list-social-icon" alt="Follow on Facebook" title="Follow on Facebook"> </a></li><li class="list-inline-item list-social-item me-3"> <a href="https://github.com/platformio" class="text-decoration-none" target="_blank"> <img src="/assets/img/icons/social/github.svg" class="list-social-icon" alt="Follow on Github" title="Follow on Github"> </a></li></ul><p class="mb-6 mb-md-2 text-gray-600"> <small>© 2014-2021 PlatformIO Labs OÜ.</small></p></div><div class="col-12 col-md-6 col-lg-2"><h6 class="text-uppercase text-gray-400"> Company</h6><ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0"><li class="mb-3"> <a href="/" class="text-reset"> Home </a></li><li class="mb-3"> <a href="/company/about.html" class="text-reset"> About Us </a></li><li class="mb-3"> <a href="/blog/" class="text-reset"> Blog </a></li><li class="mb-3"> <a href="/#contact-us" class="text-reset"> Contact Us </a></li></ul></div><div class="col-12 col-md-6 col-lg-3"><h6 class="text-uppercase text-gray-400"> Technology</h6><ul class="list-unstyled text-muted mb-6 mb-md-8 mb-lg-0"><li class="mb-3"> <a href="/technology/next-generation-ide-framework.html" class="text-reset"> Next-Gen IDE Framework </a></li><li class="mb-3"> <a href="/technology/modern-ui-toolkit.html" class="text-reset"> Modern UI Toolkit </a></li><li class="mb-3"> <a href="/technology/trusted-package-registry.html" class="text-reset"> Trusted Package Registry </a></li><li> <a href="https://platformio.org/" class="text-reset"> PlatformIO Open Source </a></li></ul></div><div class="col-12 col-md-6 col-lg-3"><h6 class="text-uppercase text-gray-400"> Legal</h6><ul class="list-unstyled text-muted mb-0"><li class="mb-3"> <a href="/legal/code-of-conduct.html" class="text-reset"> Code of Conduct </a></li><li class="mb-3"> <a href="/legal/privacy.html" class="text-reset"> Privacy Policy </a></li><li class="mb-3"> <a href="/legal/terms-of-use.html" class="text-reset"> Terms of Use </a></li><li class="mb-3"> <a href="/legal/trademarks.html" class="text-reset"> Trademarks </a></li></ul></div></div></div></footer></section><script src="/assets/js/vendor.bundle.js?v=3"></script> <script src="/assets/js/theme.bundle.js?v=3"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1768265-12"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-1768265-12'); </script></body></html>
